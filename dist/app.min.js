"use strict";document.addEventListener("DOMContentLoaded",function(){var t,l="";function n(e){var t=e.username,n=e.message,a=e.mediaUrl,r=e.timestamp,s=document.createElement("div");s.className="message";var c=new Date(r).toLocaleTimeString();s.innerHTML='\n            <div class="msg-bubble '.concat("you"===t?"user-msg":"bot-msg",'">\n                <strong>').concat(t,"</strong> <span>(").concat(c,")</span><br>\n                ").concat(n||"","\n                ").concat(a?'<br><img src="'.concat(a,'" alt="Media" style="max-width: 100%;">'):"","\n            </div>\n        "),document.getElementById("messages-container").appendChild(s),document.getElementById("messages-container").scrollTop=document.getElementById("messages-container").scrollHeight}new Ably.Realtime({key:"A2d_-A.1BaGMw:stl13eplJUOlO1UI5slUxDy9S17jg6FaoM9CsWQJYUk"}).channels.get("chat-channel").subscribe("new-message",function(e){n(e.data)}),document.getElementById("send-message-btn").addEventListener("click",function(){var t,n,a,r,s,c,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("user-message"),n=document.getElementById("file-input"),a=t.value.trim(),l){e.next=6;break}return alert("Please enter a username before sending a message."),e.abrupt("return");case 6:if(!(a||n&&0<n.files.length)){e.next=40;break}if(r="",n&&0<n.files.length)return(s=new FormData).append("file",n.files[0]),e.prev=11,e.next=14,regeneratorRuntime.awrap(fetch("/api/upload",{method:"POST",body:s}));e.next=27;break;case 14:return c=e.sent,e.next=17,regeneratorRuntime.awrap(c.json());case 17:o=e.sent,i=o.mediaUrl,r=i,e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(11),console.error("Error uploading file:",e.t0),alert("Failed to upload file."),e.abrupt("return");case 27:return e.prev=27,e.next=30,regeneratorRuntime.awrap(fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,message:a,mediaUrl:r})}));case 30:e.next=36;break;case 32:e.prev=32,e.t1=e.catch(27),console.error("Error sending message:",e.t1),alert("Failed to send message.");case 36:t.value="",n&&(n.value=""),e.next=41;break;case 40:alert("Message cannot be empty.");case 41:case"end":return e.stop()}},null,null,[[11,22],[27,32]])}),document.getElementById("username-input").addEventListener("input",function(e){l=e.target.value.trim()||"you"}),document.getElementById("clear-chat-btn").addEventListener("click",function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(fetch("/api/messages",{method:"DELETE"}));case 3:document.getElementById("messages-container").innerHTML="",e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error clearing chat:",e.t0),alert("Failed to clear chat.");case 10:case"end":return e.stop()}},null,null,[[0,6]])}),regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(fetch("/api/messages"));case 3:return t=e.sent,e.next=6,regeneratorRuntime.awrap(t.json());case 6:e.sent.forEach(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching messages:",e.t0);case 13:case"end":return e.stop()}},null,null,[[0,10]])});
//# sourceMappingURL=app.min.js.map
